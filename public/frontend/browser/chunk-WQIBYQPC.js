import{A as s,Ac as w,L as l,P as n,S as c,W as p,o as h,s as t,vc as d}from"./chunk-E5UWIP2J.js";var u=class o{constructor(e){this.http=e}apiUrl=`${w.apiUrl}/news`;cache$;getAllNews(){return this.cache$||(this.cache$=this.http.get(this.apiUrl).pipe(t(e=>(console.log("\u{1F4E1} News API Response:",e),e.success&&e.data?e.data:[])),l(1),s(this.handleError))),this.cache$}refreshCache(){console.log("\u{1F504} Clearing news cache..."),this.cache$=void 0}getNewsById(e){return this.http.get(`${this.apiUrl}/${e}`).pipe(t(r=>{if(!r.success||!r.data)throw new Error("News not found");return r.data}),s(this.handleError))}getNewsBySlug(e){return this.http.get(`${this.apiUrl}/slug/${e}`).pipe(t(r=>{if(!r.success||!r.data)throw new Error("News not found");return r.data}),s(this.handleError))}createNews(e){return this.http.post(this.apiUrl,e).pipe(t(r=>{if(!r.success||!r.data)throw new Error(r.message||"Failed to create news");return this.refreshCache(),r.data}),s(this.handleError))}updateNews(e,r){return this.http.put(`${this.apiUrl}/${e}`,r).pipe(t(a=>{if(!a.success||!a.data)throw new Error(a.message||"Failed to update news");return this.refreshCache(),a.data}),s(this.handleError))}deleteNews(e){return this.http.delete(`${this.apiUrl}/${e}`).pipe(n(()=>this.refreshCache()),t(()=>{}),s(this.handleError))}uploadCoverImage(e,r){console.log("\u{1F527} Uploading cover image:",e);let a=new FormData;return a.append("coverImage",r),this.http.post(`${this.apiUrl}/${e}/cover`,a).pipe(t(i=>{if(console.log("\u2705 Upload response:",i),!i.success||!i.data)throw new Error(i.message||"Failed to upload cover image");return this.refreshCache(),i.data}),n(i=>console.log("\u2705 Cover image uploaded:",i.coverImage)),s(this.handleError))}deleteCoverImage(e){return this.http.delete(`${this.apiUrl}/${e}/cover`).pipe(t(r=>{if(!r.success||!r.data)throw new Error(r.message||"Failed to delete cover image");return this.refreshCache(),r.data}),s(this.handleError))}incrementViews(e){return this.http.post(`${this.apiUrl}/${e}/view`,{}).pipe(t(r=>{if(!r.success||!r.data)throw new Error("Failed to increment views");return r.data}),s(this.handleError))}getNewsStats(){return this.http.get(`${this.apiUrl}/stats`).pipe(t(e=>{if(!e.success||!e.data)throw new Error("Failed to get news statistics");return e.data}),s(this.handleError))}handleError(e){let r="An error occurred";return e.error instanceof ErrorEvent?r=`Error: ${e.error.message}`:(console.error(`Backend returned code ${e.status}`),console.error("Body:",e.error),e.status===0?r="Unable to connect to server. Please check if the backend is running.":e.error&&e.error.message?r=e.error.message:r=`Server Error: ${e.status} - ${e.statusText}`),console.error("\u274C HTTP Error:",r),h(()=>new Error(r))}static \u0275fac=function(r){return new(r||o)(p(d))};static \u0275prov=c({token:o,factory:o.\u0275fac,providedIn:"root"})};export{u as a};
