import './polyfills.server.mjs';
import{a as f}from"./chunk-2MWTOOCD.mjs";import{K as i,N as d,Qc as h,R as u,Rc as C,g as p,k as g,o as a,w as o}from"./chunk-MQOS27Y4.mjs";var m=class c{constructor(e){this.http=e;console.log("\u{1F393} [COACH SERVICE] Initialized")}apiUrl=`${f.apiUrl}/coaches`;refreshSubject=new p(void 0);refresh$=this.refreshSubject.asObservable();getCoaches(e=1,t=10,r="Semua",s="",E="createdAt",b="desc"){console.log("\u{1F4CB} [COACH SERVICE] Getting coaches with pagination");let n=new h().set("page",e.toString()).set("limit",t.toString()).set("sortBy",E).set("order",b);return r&&r!=="Semua"&&(n=n.set("status",r)),s&&s.trim()&&(n=n.set("search",s.trim())),this.http.get(this.apiUrl,{params:n}).pipe(i(l=>{console.log("\u{1F4E1} Coaches response:",{count:l.data?.length||0,pagination:l.pagination})}),o(this.handleError))}getAllCoachesSimple(){return console.log("\u{1F4CB} [COACH SERVICE] Getting all coaches (simple list)"),this.http.get(`${this.apiUrl}/simple`).pipe(a(e=>!e.success||!e.data?[]:(console.log(`\u2705 Loaded ${e.data.length} coaches (simple)`),e.data)),o(this.handleError))}getCoachById(e){return console.log("\u{1F50D} [COACH SERVICE] Getting coach by ID:",e),this.http.get(`${this.apiUrl}/${e}`).pipe(a(t=>{if(!t.success||!t.data)throw new Error("Coach not found");return t.data}),o(this.handleError))}createCoach(e){return console.log("\u2795 [COACH SERVICE] Creating coach:",e.fullName),this.http.post(this.apiUrl,e).pipe(a(t=>{if(!t.success||!t.data)throw new Error(t.message||"Failed to create coach");return console.log("\u2705 Coach created:",t.data.fullName),t.data}),i(()=>this.triggerRefresh()),o(this.handleError))}updateCoach(e,t){return console.log("\u270F\uFE0F [COACH SERVICE] Updating coach:",e),this.http.put(`${this.apiUrl}/${e}`,t).pipe(a(r=>{if(!r.success||!r.data)throw new Error(r.message||"Failed to update coach");return console.log("\u2705 Coach updated:",r.data.fullName),r.data}),i(()=>this.triggerRefresh()),o(this.handleError))}deleteCoach(e){return console.log("\u{1F5D1}\uFE0F [COACH SERVICE] Deleting coach:",e),this.http.delete(`${this.apiUrl}/${e}`).pipe(i(()=>{console.log("\u2705 Coach deleted"),this.triggerRefresh()}),a(()=>{}),o(this.handleError))}uploadPhoto(e,t){console.log("\u{1F4F8} [COACH SERVICE] Uploading photo for coach:",e);let r=new FormData;return r.append("photo",t),this.http.post(`${this.apiUrl}/${e}/photo`,r).pipe(a(s=>{if(!s.success)throw new Error(s.message||"Failed to upload photo");return console.log("\u2705 Photo uploaded:",s.photo),{photo:s.photo}}),i(()=>this.triggerRefresh()),o(this.handleError))}deletePhoto(e){return console.log("\u{1F5D1}\uFE0F [COACH SERVICE] Deleting photo for coach:",e),this.http.delete(`${this.apiUrl}/${e}/photo`).pipe(a(t=>{if(!t.success||!t.data)throw new Error(t.message||"Failed to delete photo");return console.log("\u2705 Photo deleted"),t.data}),i(()=>this.triggerRefresh()),o(this.handleError))}getCoachStats(){return console.log("\u{1F4CA} [COACH SERVICE] Getting statistics"),this.http.get(`${this.apiUrl}/stats`).pipe(a(e=>{if(!e.success||!e.data)throw new Error("Failed to get coach statistics");return console.log("\u2705 Stats retrieved"),e.data}),o(this.handleError))}searchCoaches(e){console.log("\u{1F50D} [COACH SERVICE] Searching coaches:",e);let t=new h().set("q",e);return this.http.get(`${this.apiUrl}/search`,{params:t}).pipe(a(r=>!r.success||!r.data?[]:(console.log(`\u2705 Found ${r.data.length} coaches`),r.data)),o(this.handleError))}filterByStatus(e){console.log("\u{1F50D} [COACH SERVICE] Filtering by status:",e);let t=new h().set("status",e);return this.http.get(`${this.apiUrl}/filter`,{params:t}).pipe(a(r=>!r.success||!r.data?[]:(console.log(`\u2705 Found ${r.data.length} coaches`),r.data)),o(this.handleError))}triggerRefresh(){console.log("\u{1F504} [COACH SERVICE] Triggering refresh"),this.refreshSubject.next()}handleError(e){let t="An error occurred";return e.error instanceof ErrorEvent?t=`Error: ${e.error.message}`:(console.error("\u274C Backend error:",{status:e.status,statusText:e.statusText,body:e.error}),e.status===0?t="Unable to connect to server. Please check if the backend is running.":e.error?.message?t=e.error.message:e.error?.error?t=e.error.error:t=`Server Error: ${e.status} - ${e.statusText}`),console.error("\u274C [COACH SERVICE] Error:",t),g(()=>new Error(t))}static \u0275fac=function(t){return new(t||c)(u(C))};static \u0275prov=d({token:c,factory:c.\u0275fac,providedIn:"root"})};export{m as a};
