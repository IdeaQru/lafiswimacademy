import './polyfills.server.mjs';
import{a as u}from"./chunk-2MWTOOCD.mjs";import{H as n,L as h,Nc as d,O as p,S as l,k as c,o as r,w as a}from"./chunk-LYSTPZ4M.mjs";var f=class i{constructor(e){this.http=e}apiUrl=`${u.apiUrl}/coaches`;cache$;getCoaches(){return this.cache$||(this.cache$=this.http.get(this.apiUrl).pipe(r(e=>(console.log("\u{1F4E1} Coaches API Response:",e),e.success&&e.data?e.data:[])),n(1),a(this.handleError))),this.cache$}refreshCache(){console.log("\u{1F504} Clearing coaches cache..."),this.cache$=void 0}getCoachById(e){return this.http.get(`${this.apiUrl}/${e}`).pipe(r(t=>{if(!t.success||!t.data)throw new Error("Coach not found");return t.data}),a(this.handleError))}createCoach(e){return this.http.post(this.apiUrl,e).pipe(r(t=>{if(!t.success||!t.data)throw new Error(t.message||"Failed to create coach");return this.refreshCache(),t.data}),a(this.handleError))}updateCoach(e,t){return this.http.put(`${this.apiUrl}/${e}`,t).pipe(r(o=>{if(!o.success||!o.data)throw new Error(o.message||"Failed to update coach");return this.refreshCache(),o.data}),a(this.handleError))}deleteCoach(e){return this.http.delete(`${this.apiUrl}/${e}`).pipe(h(()=>this.refreshCache()),r(()=>{}),a(this.handleError))}uploadPhoto(e,t){console.log("\u{1F527} Uploading coach photo:",e);let o=new FormData;return o.append("photo",t),this.http.post(`${this.apiUrl}/${e}/photo`,o).pipe(r(s=>{if(console.log("\u2705 Upload response:",s),!s.success||!s.data)throw new Error(s.message||"Failed to upload photo");return this.refreshCache(),s.data}),h(s=>console.log("\u2705 Photo uploaded:",s.photo)),a(this.handleError))}deletePhoto(e){return this.http.delete(`${this.apiUrl}/${e}/photo`).pipe(r(t=>{if(!t.success||!t.data)throw new Error(t.message||"Failed to delete photo");return this.refreshCache(),t.data}),a(this.handleError))}getCoachStats(){return this.http.get(`${this.apiUrl}/stats`).pipe(r(e=>{if(!e.success||!e.data)throw new Error("Failed to get coach statistics");return e.data}),a(this.handleError))}handleError(e){let t="An error occurred";return e.error instanceof ErrorEvent?t=`Error: ${e.error.message}`:(console.error(`Backend returned code ${e.status}`),console.error("Body:",e.error),e.status===0?t="Unable to connect to server. Please check if the backend is running.":e.error&&e.error.message?t=e.error.message:t=`Server Error: ${e.status} - ${e.statusText}`),console.error("\u274C HTTP Error:",t),c(()=>new Error(t))}static \u0275fac=function(t){return new(t||i)(l(d))};static \u0275prov=p({token:i,factory:i.\u0275fac,providedIn:"root"})};export{f as a};
