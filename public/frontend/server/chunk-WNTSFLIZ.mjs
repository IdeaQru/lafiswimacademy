import './polyfills.server.mjs';
import{a as u}from"./chunk-2MWTOOCD.mjs";import{K as i,N as o,R as p,Rc as d,g as l,k as h,o as r,w as a}from"./chunk-MQOS27Y4.mjs";var c=class n{constructor(e){this.http=e}apiUrl=`${u.apiUrl}/news`;cacheSubject=new l(!1);cache$=this.cacheSubject.asObservable();getAllNews(){return this.http.get(this.apiUrl).pipe(i(e=>{console.log("\u{1F50D} Raw Response:",e),console.log("\u{1F50D} Total data:",e?.data?.length||"unknown")}),r(e=>e&&e.data?(console.log("\u2705 Mapped data count:",e.data.length),e.data):e),a(this.handleError))}getAllNewsSimple(){return this.http.get(`${this.apiUrl}/simple`).pipe(r(e=>e.data),a(this.handleError))}getNewsById(e){return this.http.get(`${this.apiUrl}/${e}`).pipe(r(t=>t&&t.data?t.data:t),a(this.handleError))}getNewsBySlug(e){return this.http.get(`${this.apiUrl}/slug/${e}`).pipe(r(t=>t&&t.data?t.data:t),a(this.handleError))}createNews(e){return this.http.post(this.apiUrl,e).pipe(r(t=>t&&t.data?t.data:t),i(()=>this.refreshCache()),a(this.handleError))}updateNews(e,t){return this.http.put(`${this.apiUrl}/${e}`,t).pipe(r(s=>s&&s.data?s.data:s),i(()=>this.refreshCache()),a(this.handleError))}deleteNews(e){return this.http.delete(`${this.apiUrl}/${e}`).pipe(i(()=>this.refreshCache()),a(this.handleError))}uploadCoverImage(e,t){let s=new FormData;return s.append("coverImage",t),this.http.post(`${this.apiUrl}/${e}/upload-cover`,s).pipe(i(()=>this.refreshCache()),a(this.handleError))}incrementViews(e){return this.http.patch(`${this.apiUrl}/${e}/views`,{}).pipe(r(t=>t&&t.data?t.data:t),a(this.handleError))}getFeaturedNews(){return this.http.get(`${this.apiUrl}/featured`).pipe(r(e=>e&&e.data?e.data:e),a(this.handleError))}getPublishedNews(){return this.http.get(`${this.apiUrl}/published`).pipe(r(e=>e&&e.data?e.data:e),a(this.handleError))}getNewsByCategory(e){return this.http.get(`${this.apiUrl}/category/${e}`).pipe(r(t=>t&&t.data?t.data:t),a(this.handleError))}refreshCache(){this.cacheSubject.next(!0)}handleError(e){let t="Terjadi kesalahan";return e.error instanceof ErrorEvent?t=`Error: ${e.error.message}`:e.status===0?t="Tidak dapat terhubung ke server. Periksa koneksi internet Anda.":e.status===404?t="Data tidak ditemukan.":e.status===400?t=e.error?.message||"Data tidak valid.":e.status===500?t="Terjadi kesalahan pada server.":t=e.error?.message||`Error Code: ${e.status}`,console.error("\u274C HTTP Error:",e),h(()=>new Error(t))}static \u0275fac=function(t){return new(t||n)(p(d))};static \u0275prov=o({token:n,factory:n.\u0275fac,providedIn:"root"})};export{c as a};
